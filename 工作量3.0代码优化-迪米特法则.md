# 定义
迪米特法则（Law of Demeter ,LoD），也成为最少知道原则（Last Knowledge Principle,LKP）。何为最少知道，就是一个类只能和自己的朋友类交流，那何为朋友类呢，朋友类是一个类的输入和输出中的类成为朋友类。

# 实例（1）
根据案件类别、审判程序、浮动类型和浮动项获取浮动区间类型的浮动信息

### 重构前代码

```java
public List<TPzPtfdgzlFdz> getFdgzlAjFdqjxx(Integer ajlx, Integer ajzlx, Integer fdlx, Integer fdx) {
  List<TPzPtfdgzlFdz> fdgzlList = null;
  Integer sycx = ArteryParamUtil.getInteger("sycx");
  FdxCs cs = getFdxCs(ajlx, ajzlx, sycx, fdlx, fdx);
  String pzfy = GzlpgUtil.getPzfyByFyAndJsjb();
  String curFy = GzlpgUtil.getCurrFy();
  String fy = StringUtils.isBlank(pzfy) ? curFy : pzfy;
  if (cs.getSycx() != null) {
    fdgzlList = fdgzlpzDao.getFdgzlAjsjxx(fy, cs);
  } else {
    fdgzlList = fdgzlpzDao.getFdgzlAjsjxxWsycx(fy, cs);
  }
  return fdgzlList;
}
```

问题：因为FdxCs 和 fy 既不是输入参数也不是返回参数，则不是朋友类，但是这里getFdgzlAjFdqjxx方法中却产生了交流，`getFdxCs（）`和`StringUtils.isBlank(pzfy) ? curFy : pzfy;`

### 重构后代码

```java
public List<TPzPtfdgzlFdz> getFdgzlAjFdqjxx(String fy, FdxCs cs) {
  List<TPzPtfdgzlFdz> fdgzlList = null;
  if (cs.getSycx() != null) {
    fdgzlList = fdgzlpzDao.getFdgzlAjsjxx(fy, cs);
  } else {
    fdgzlList = fdgzlpzDao.getFdgzlAjsjxxWsycx(fy, cs);
  }
  return fdgzlList;
}
```

### 总结 

根据迪米特法则，将不是朋友类的部分提出到Logic处理，这也符合逻辑层的功能，收集加工数据，不处理逻辑，然后将处理后的数据传到service。

# 实例（2）

获取刑事案件人数浮动信息

### 重构前代码

````java
/**
     * 获取刑事案件人数浮动信息
     * 
     * @param fy 法院
     * @param ajlb 案件类别
     * @param spcx 审判程序
     * @param sars 涉案人数类型
     * @return
     */
private List<TPzPtfdgzlFdz> getRsfdgzlList(String fy, Integer ajlb, Integer spcx, Integer sars) {
  List<TPzPtfdgzlFdz> fdgzlList = null;
  Integer sycx = ArteryParamUtil.getInteger("sycx");
  FdxCs cs = getFdxCs(ajlb, spcx, sycx, Consts.N_FDLX_QJ, sars);
  if (cs.getSycx() != null) {
    fdgzlList = fdgzlpzDao.getFdgzlAjsjxx(fy, cs);
  } else {
    fdgzlList = fdgzlpzDao.getFdgzlAjsjxxWsycx(fy, cs);
  }
  return fdgzlList;
}
````

- 问题：
  - service层中的服务类，还在调用ArteryParamUtil.getInteger 来获取缓存传来的参数，这本应该在Logic层获取的数据
  - FdxCs 不属于朋友类，也应该在Logic处理
  - fdgzlpzDao public 方法太多，一旦改动，则getRsfdgzlList方法也要改动

### 重构后代码

````java
private List<TPzPtfdgzlFdz> getRsfdgzlList(String fy, FdxCs cs) {
  return fdgzlpzDao.getFdgzlAjsjxxByFdxCs(fy, cs);
}
````

````java
public getFdgzlAjsjxxByFdxCs(String fy, FdxCs cs){
  List<TPzPtfdgzlFdz> result = null;
  if (cs.getSycx() != null) {
    result = this.getFdgzlAjsjxx(fy, cs);
  } else {
    result = this.getFdgzlAjsjxxWsycx(fy, cs);
  }
  return result;
}
````

总结：迪米特法则要求“羞涩”一点，尽量不要对外公布太多public方法和非静态方法的public变量，尽量内敛，多实用private、package-private、protected等访权限。