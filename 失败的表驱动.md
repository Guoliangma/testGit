### 问题代码 

````java
/**
     * 数据源查询方法
     * 
     * @param qp
     *            查询参数，只在分页查询时可用，否则为null
     * @return Object 当为分页查询时，需要返回IPagableData对象，否则可为任意pojo
     */
    public Object listReporting(IQueryInfo qp) {
        String corpId = ArteryParamUtil.getString(ParamNameConsts.CORP_ID);
        String cStatus = ArteryParamUtil.getString(ParamNameConsts.C_STATUS);
        String reportingReportId = ArteryParamUtil.getString(ParamNameConsts.C_REPORTING_REPORT_ID);
        String reportingId = ArteryParamUtil.getString(ParamNameConsts.REPORTING_ID);
        String isShow = ArteryParamUtil.getString(ParamNameConsts.IS_SHOW);
        List<Map<String, Object>> reportings = null;
        if (StringUtils.isNotBlank(corpId) && StringUtils.isNotBlank(reportingId)) {
            TReporting tReporting = reportingService.getReportingById(reportingId);
            Integer year = tReporting.getNYear();
            Integer month = tReporting.getNMonth();
            reportings = reportingService.listByYearMonthCorp(year, month, corpId);
            return rightFilter(reportings);
        }
        //点击年月只查看所有的信息
        if (StringUtils.isNotBlank(isShow) && StringUtils.isNotBlank(reportingId)) {
            return reportingService.listByReportingId(reportingId);
        }
        
        //历史上报数据查看
        if (CommonConsts.BBZT_JSGD.equals(cStatus)) {
            List<Map<String, Object>> listByCorpAndStatus = reportingService.listByCorpAndStatus(getCurrentUserCorp().getId(), cStatus);
            List<Map<String, Object>> listByCorpAndStatusTwo = reportingService.listByCorpAndStatus(getCurrentUserCorp().getId(), CommonConsts.BBZT_DJS);
            listByCorpAndStatusTwo.addAll(listByCorpAndStatus);
            return listByCorpAndStatusTwo;
        }
        if (StringUtils.isNotBlank(reportingId)) {
            reportings = reportingService.listByReportingId(reportingId);
        } else {
            reportings = reportingService.listByCorpAndStatus(getCurrentUserCorp().getId(), cStatus);
        }
        if (StringUtils.isNotBlank(reportingReportId)) {
            TReportingReport report = reportingReportService.getReporById(reportingReportId);
            reportings = reportingService.listByReportingId(report.getCReportingId());
            return reportings; //具体的报表点击查看不过滤权限
        }
        rightFilter(reportings);
        return reportings;
    }
    
    private List<Map<String, Object>> rightFilter(List<Map<String, Object>> reportings) {
        Iterator<Map<String, Object>> itr = reportings.iterator();
        while (itr.hasNext()) {
            Map<String, Object> map = itr.next();
            String spjd = MapUtils.getString(map, "C_LAST_SPJD", "");
            if (StringUtils.isBlank(spjd)) {
                itr.remove(); //还未提交审批流程
                continue;
            }
            String lclb = MapUtils.getString(map, "C_TYPE");
            if (CommonConsts.LCLB_JYJLC.equals(lclb)) {
                itr.remove();
                continue;
            }
            if (CommonConsts.SPJD_JYKYTQ.equals(spjd)) { //可以撤回
                continue;
            }
            String rightKey = SpjdCodeMap.jySpjdRightMap.get(spjd);
            String rightArr[] = rightKey.split("\\|");
            boolean flag = false; //默认无权限
            for (String key : rightArr) {
                flag = hasRight(key);
            }
            if (!flag) {
                itr.remove();
            }
        }
        return reportings;
    }
````

存在问题 ：大量if else  判断

失败的修改：

````java
 /**
 * 监狱报表 服务器端逻辑类
 * 
 * @author zheng
 * @date 2018-02-26
 * @id fcb0f82baf4f38fe4617c57327e08ae7
 */
public class JyReporting extends BaseLogic {

  protected LogicClassContext context = LogicClassContext.getInstance();

  @Autowired
  private ReportingService reportingService;

  @Autowired
  private ReportingReportService reportingReportService;

  /**
     * 具体监狱跳转-带权限
     */
  private static final int JTJYTZ_QX = 1;

  /**
     * 点击年月只查看所有的信息
     */
  private static final int DJNYTZ = 2;

  /**
     * 历史上报数据查看
     */
  private static final int LSSBSJ = 3;

  /**
     * 具体期次访问-带权限
     */
  private static final int JTQC_QX = 4;

  /**
     * 根据当前用户和状态查看-带权限
     */
  private static final int YH_ZT_QX = 5;

  /**
     * 根据具体报表查看-带权限
     */
  private static final int JTBB_QX = 6;

  /**
     * 定义报表展示的规则
     */
  private Map<String, Integer> reportingsMap = new HashMap<String, Integer>();

  {
    reportingsMap.put("corpId-&-&-reportingId-&", JTJYTZ_QX);
    reportingsMap.put("&-&-&-reportingId-isShow", DJNYTZ);
    reportingsMap.put("&-6-&-&-&", LSSBSJ);
    reportingsMap.put("&-&-&-reportingId-&", JTQC_QX);
    reportingsMap.put("&-cStatus-&-&-&", YH_ZT_QX);//
    reportingsMap.put("&-&-reportingReportId-&-&", JTBB_QX);

  }

  /**
     * 数据源查询方法
     * 
     * @param qp
     *            查询参数，只在分页查询时可用，否则为null
     * @return Object 当为分页查询时，需要返回IPagableData对象，否则可为任意pojo
     */
  public Object listReporting(IQueryInfo qp) {
    String corpId = ArteryParamUtil.getString(ParamNameConsts.CORP_ID);
    String cStatus = ArteryParamUtil.getString(ParamNameConsts.C_STATUS);
    String reportingReportId =                    ArteryParamUtil.getString(ParamNameConsts.C_REPORTING_REPORT_ID);
    String reportingId = ArteryParamUtil.getString(ParamNameConsts.REPORTING_ID);
    String isShow = ArteryParamUtil.getString(ParamNameConsts.IS_SHOW);
    List<Map<String, Object>> reportings = null;
    String corpKey = corpId == null ? "&" : "corpId";
    String cStatusKey = cStatus == null ? "-&" : "-cStatus";
    String reportingReportKey = reportingReportId == null ? "-&" : "-reportingReportId";
    String reportingKey = reportingId == null ? "-&" : "-reportingId";
    String isShowKey = isShow == null ? "-&" : "-isShow";
    String key = corpKey + cStatusKey + reportingReportKey + reportingKey + isShowKey;

    if (CommonConsts.BBZT_JSGD.equals(cStatus)) {
      key = "&-" + cStatus + "-&" + "-&" + "-&";
    }
    Integer value = reportingsMap.get(key);
    if (value != null) {
      switch (value) {

        case JTJYTZ_QX:
          reportings = jumpJyDetail(corpId, reportingId);
          break;
        case DJNYTZ:
          reportings = jumpNyDetail(reportingId);
          break;
        case LSSBSJ:
          reportings = jumpLsDetail();
          break;
        case JTQC_QX:
          reportings = jumpReportingDetail(reportingId);
          break;
        case YH_ZT_QX:
          reportings = jumpReportingByStatus(cStatus);
          break;
        case JTBB_QX:
          reportings = jumpReportingByReporId(reportingReportId);
          break;

      }
    }
    return reportings;
  }

  /**
     * 点击年月只查看所有的信息
     * @param reportingId
     * @return
     */
  private List<Map<String, Object>> jumpNyDetail(String reportingId) {
    return reportingService.listByReportingId(reportingId);
  }

  /**
     * 根据具体报表查看-带权限
     * @param reportingReportId
     * @return
     */
  private List<Map<String, Object>> jumpReportingByReporId(String reportingReportId) {
    TReportingReport report = reportingReportService.getReporById(reportingReportId);
    return rightFilter(reportingService.listByReportingId(report.getCReportingId()));
  }

  /**
     * 根据当前用户和状态查看-带权限
     * @param cStatus
     * @return
     */
  private List<Map<String, Object>> jumpReportingByStatus(String cStatus) {
    List<Map<String, Object>> reportings = reportingService.listByCorpAndStatus(getCurrentUserCorp().getId(), cStatus);
    return rightFilter(reportings);
  }

  /**
     * 历史上报数据查看
     * @return
     */
  private List<Map<String, Object>> jumpLsDetail() {
    List<Map<String, Object>> listByCorpAndStatus = reportingService.listByCorpAndStatus(getCurrentUserCorp().getId(),
                                                                                         CommonConsts.BBZT_JSGD);
    List<Map<String, Object>> listByCorpAndStatusTwo = reportingService.listByCorpAndStatus(getCurrentUserCorp().getId(),
                                                                                            CommonConsts.BBZT_DJS);
    listByCorpAndStatusTwo.addAll(listByCorpAndStatus);
    return listByCorpAndStatusTwo;
  }

  /**
     * 具体报表访问-带权限
     * @param reportingId
     * @return
     */
  private List<Map<String, Object>> jumpReportingDetail(String reportingId) {
    return rightFilter(reportingService.listByReportingId(reportingId));
  }

  /**
     * 具体监狱跳转-带权限
     * @param corpId
     * @param reportingId
     * @return
     */
  private List<Map<String, Object>> jumpJyDetail(String corpId, String reportingId) {
    TReporting tReporting = reportingService.getReportingById(reportingId);
    Integer year = tReporting.getNYear();
    Integer month = tReporting.getNMonth();
    List<Map<String, Object>> reportings = reportingService.listByYearMonthCorp(year, month, corpId);
    return rightFilter(reportings);
  }

  /**
     * 我是权限
     * @param reportings
     * @return
     */
  private List<Map<String, Object>> rightFilter(List<Map<String, Object>> reportings) {
    Iterator<Map<String, Object>> itr = reportings.iterator();
    while (itr.hasNext()) {
      Map<String, Object> map = itr.next();
      String spjd = MapUtils.getString(map, "C_LAST_SPJD", "");
      if (StringUtils.isBlank(spjd)) {
        itr.remove(); //还未提交审批流程
        continue;
      }
      String lclb = MapUtils.getString(map, "C_TYPE");
      if (CommonConsts.LCLB_JYJLC.equals(lclb)) {
        itr.remove();
        continue;
      }
      if (CommonConsts.SPJD_JYKYTQ.equals(spjd)) { //可以撤回
        continue;
      }
      String rightKey = SpjdCodeMap.jySpjdRightMap.get(spjd);
      String rightArr[] = rightKey.split("\\|");
      boolean flag = false; //默认无权限
      for (String key : rightArr) {
        flag = hasRight(key);
      }
      if (!flag) {
        itr.remove();
      }
    }
    return reportings;
  }
}
````

