# 策略模式定义
赔了夫人又折兵，正式策略模式的体现。诸葛亮给赵云的三个锦囊救刘备回西川，其中三个妙计分别是：找乔国老帮忙（走后门），求吴国太方行（诉苦），孙夫人断后，赵云依次使用这三个妙计保刘备全身而退。


# 实例
根据浮动项值获取执行案件浮动工作量列表Map中的Key

### 重构前代码

```java
/**
     * 根据案件类别、浮动项值获取浮动工作量列表案件涉及Map中的Key
     * @param ajlx   案件类型
     * @param ajzlx  案件子类型
     * @param fdxz   浮动项值
     * @return
     */
    private String getFdgzlAjLbMc(Integer ajlx, Integer ajzlx, Integer fdxz) {
        if (Consts.N_AJLX_XSAJ.equals(ajlx)) {
            if (Consts.N_AJZLX_XS_ZSSCYSPJD.equals(ajzlx)) {
                return getJdfdgzlAjLbMc(fdxz);
            }
            return getXsfdgzlAjLbMc(fdxz);
        } else if (Consts.N_AJLX_MSAJ.equals(ajlx)) {
            if (Consts.N_AJZLX_MS_ZSSCYSPJD.equals(ajzlx)) {
                return getJdfdgzlAjLbMc(fdxz);
            }
            return getMsfdgzlAjLbMc(fdxz);
        } else if (Consts.N_AJLX_XZAJ.equals(ajlx)) {
            if (Consts.N_AJZLX_XZ_ZSSCYSPJD.equals(ajzlx)) {
                return getJdfdgzlAjLbMc(fdxz);
            }
            return getXzfdgzlAjLbMc(fdxz);
        } else if (Consts.N_AJLX_ZXAJ.equals(ajlx)) {
            return getZxfdgzlAjLbMc(fdxz);
        } else if (Consts.N_AJLX_QZQSYPC.equals(ajlx)) {
            return getMsfdgzlAjLbMc(fdxz);
        }
        return null;
    }
```

### 重构后代码

```java
/**
 * AjlbmcStrategy
 * 
 * @author maguoliang
 * @version 1.0
 *
 */
public interface AjlbmcStrategy {
    public String querryAjlbmc(Integer ajzlx, Integer fdxz);
}
```



```java
	     /**
     * 根据案件类别、浮动项值获取浮动工作量列表案件涉及Map中的Key
     * @param ajlx   案件类型
     * @param ajzlx  案件子类型
     * @param fdxz   浮动项值
     * @return
     */
    private String getFdgzlAjLbMc(Integer ajlx, Integer ajzlx, Integer fdxz) {
        AjlbmcStrategy query = fdgzlAjLbByAjlx.get(ajlx);
        Context con = new Context(query);
        return con.operate(ajzlx, fdxz);
    }
    
```

- 表驱动

```java
private static Map<Integer, AjlbmcStrategy> fdgzlAjLbByAjlx = new ConcurrentHashMap<Integer, AjlbmcStrategy>();

{
  fdgzlAjLbByAjlx.put(Consts.N_AJLX_XSAJ, new XslbMc());
  fdgzlAjLbByAjlx.put(Consts.N_AJLX_MSAJ, new MslbMc());
  fdgzlAjLbByAjlx.put(Consts.N_AJLX_XZAJ, new XzlbMc());
  fdgzlAjLbByAjlx.put(Consts.N_AJLX_ZXAJ, new ZxlbMc());
  fdgzlAjLbByAjlx.put(Consts.N_AJLX_QZQSYPC, new QzlbMc());

}
```

- 实现类(1)

  ````java
  public class QzlbMc implements AjlbmcStrategy {

    private static Map<Integer, String> msfdgzlAjLbMap = new ConcurrentHashMap<Integer, String>();

    {
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SNMGGZ, "mssnmggz");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SZDBC, "msszdbc");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SCQAZBC, "msscqazbc");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SCPZL, "msscpzl");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SHJWR, "msshjwr");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SYLJF, "mssyljf");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SHTQZ, "msshtqz");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SFWQZ, "mssfwqz");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SDKQZ, "mssdkqz");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SHWQ, "msshwq");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SZSCQ, "msszscq");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SHSHS, "msshshs");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SWTOGZ, "msswtogz");
      msfdgzlAjLbMap.put(Consts.N_AJSJ_MS_SJUN, "mssjun");
    }

    /**
       * (non-Javadoc)
       * 
       * @see com.thunisoft.gzlpg.fdgzlpz.service.AjlbmcStrategy#querryAjlbmc(java.lang.Integer, java.lang.Integer)
       */
    @Override
    public String querryAjlbmc(Integer ajzlx, Integer fdxz) {
      return msfdgzlAjLbMap.get(fdxz);
    }
  }
  ````



- 实现类(2)

  ````java
  public class MslbMc implements AjlbmcStrategy {

      private static Map<Integer, String> fdgzlAjLbMap = new ConcurrentHashMap<Integer, String>();

      {
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SGJAQ, "jdsgjaq");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SQ, "jdsq");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SH, "jdsh");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SD, "jdsd");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SFLG, "jdsflg");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SNMGGZ, "jdsnmggz");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SZDBC, "jdszdbc");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SCQAZBC, "jdscqazbc");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SCPZL, "jdscpzl");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SHJWR, "jdshjwr");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SYLJF, "jdsyljf");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SHTQZ, "jdshtqz");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SFWQZ, "jdsfwqz");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SBXQZ, "jdsbxqz");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SDKQZ, "jdsdkqz");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SHWQ, "jdshwq");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SZSCQ, "jdszscq");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SHSHS, "jdshshs");
          fdgzlAjLbMap.put(Consts.N_AJSJ_JD_SWTOGZ, "jdswtogz");

      }

      private static Map<Integer, String> msfdgzlAjLbByAjlx = new ConcurrentHashMap<Integer, String>();
      
      {
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SNMGGZ, "mssnmggz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SZDBC, "msszdbc");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SCQAZBC, "msscqazbc");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SCPZL, "msscpzl");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SHJWR, "msshjwr");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SYLJF, "mssyljf");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SHTQZ, "msshtqz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SFWQZ, "mssfwqz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SFWQZ, "mssbxqz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SBXQZ, "mssdkqz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SDKQZ, "mssdkqz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SHWQ, "msshwq");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SZSCQ, "msszscq");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SHSHS, "msshshs");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SWTOGZ, "msswtogz");
          msfdgzlAjLbByAjlx.put(Consts.N_AJSJ_MS_SJUN, "mssjun");
          
          
      }
      /**
       * (non-Javadoc)
       * 
       * @see com.thunisoft.gzlpg.fdgzlpz.service.AjlbmcStrategy#querryAjlbmc(java.lang.Integer, java.lang.Integer)
       */
      @Override
      public String querryAjlbmc(Integer ajzlx, Integer fdxz) {
          if (Consts.N_AJZLX_MS_ZSSCYSPJD.equals(ajzlx)) {
              return fdgzlAjLbMap.get(fdxz);
          }
          return msfdgzlAjLbByAjlx.get(fdxz);
      }

  }
  ````

  ​总结，重构前方法中存在大量的if else 判断中充斥这各种方法的调用，但是返回结果和传入参数相似，所有考虑到使用策略模式结合表驱动的方法，去掉方法中大量的if esle 使得代码可维护性增强，单个实现类的抽取，也符合单一职责原则。